
local Players = game:GetService("Players")
local player = Players.LocalPlayer

local whitelist = { 
    "ALIGEMSKG1", 
     "DEMENT3DX",
    "Iowtoya", 
    "iowtoya", 
    "m85m", 
    "rektifn", 
    "E3QOO", 
    "Shadowformerks", 
    "ccpb"
}

local function isWhitelisted(username)
    for _, allowed in ipairs(whitelist) do
        if string.lower(username) == string.lower(allowed) then
            return true
        end
    end
    return false
end

if not isWhitelisted(player.Name) then
    player:Kick("Fuck Off | Lemonhub حساب غير مدعوم")
    return
end

game:GetService("StarterGui"):SetCore("SendNotification", {
        Title = "⚠️تحذير مهم ⚠️",
        Text = "فعل مضاد قتل أولا",
        Button1 = "أخفاء",
        Duration = 5
    })
 wait(1)
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local playerGui = player:WaitForChild("PlayerGui")

local screenGui = Instance.new("ScreenGui")
screenGui.Name = "LemonHub v3"
screenGui.ResetOnSpawn = false
screenGui.Parent = playerGui

local mainFrame = Instance.new("Frame")
mainFrame.Size = UDim2.new(0, 250, 0, 320)
mainFrame.Position = UDim2.new(0.5, -125, 0.5, -160)
mainFrame.AnchorPoint = Vector2.new(0.5, 0.5)
mainFrame.BackgroundColor3 = Color3.fromRGB(0,0,0)
mainFrame.BackgroundTransparency = 0.2
mainFrame.Parent = screenGui

local frameCorner = Instance.new("UICorner")
frameCorner.CornerRadius = UDim.new(0,15)
frameCorner.Parent = mainFrame

local title = Instance.new("TextLabel")
title.Size = UDim2.new(1,0,0,35)
title.BackgroundTransparency = 1
title.Text = "LemonHub v3"
title.TextColor3 = Color3.fromRGB(255,255,255)
title.TextScaled = true
title.Font = Enum.Font.GothamBold
title.Parent = mainFrame

local usernameBox = Instance.new("TextBox")
usernameBox.Size = UDim2.new(0.9,0,0,25)
usernameBox.Position = UDim2.new(0.05,0,0,45)
usernameBox.BackgroundColor3 = Color3.fromRGB(20,20,20)
usernameBox.TextColor3 = Color3.fromRGB(255,255,255)
usernameBox.PlaceholderText = "وش اسمه؟ "
usernameBox.ClearTextOnFocus = false
usernameBox.Font = Enum.Font.Gotham
usernameBox.TextScaled = true
usernameBox.Parent = mainFrame

local function createButton(name, y)
    local btn = Instance.new("TextButton")
    btn.Size = UDim2.new(0.9,0,0,25)
    btn.Position = UDim2.new(0.05,0,0,y)
    btn.BackgroundColor3 = Color3.fromRGB(30,30,30)
    btn.TextColor3 = Color3.fromRGB(255,255,255)
    btn.Text = name
    btn.Font = Enum.Font.GothamBold
    btn.TextScaled = true
    btn.Parent = mainFrame
    local btnCorner = Instance.new("UICorner")
    btnCorner.CornerRadius = UDim.new(0,10)
    btnCorner.Parent = btn
    return btn
end

local pullButton = createButton("سحب", 80)
local killButton = createButton("قتل", 115)
local foidButton = createButton("فويد", 150)
local teleportButton = createButton("تنقل", 185)
local viewButton = createButton("مشاهده", 220)
local antiAfkButton = createButton("مضاد افك", 255)
local antiKillButton = createButton("مضاد قتل", 290)

local function enableDragging(frame)
    local dragging = false
    local dragInput, dragStart, startPos
    local function update(input)
        local delta = input.Position - dragStart
        frame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
    end
    frame.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            dragging = true
            dragStart = input.Position
            startPos = frame.Position
            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    dragging = false
                end
            end)
        end
    end)
    frame.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
            dragInput = input
        end
    end)
    UserInputService.InputChanged:Connect(function(input)
        if input == dragInput and dragging then
            update(input)
        end
    end)
end

enableDragging(mainFrame)

local guiVisible = true
local function toggleGui()
    guiVisible = not guiVisible
    screenGui.Enabled = guiVisible
end

UserInputService.InputBegan:Connect(function(input, gameProcessed)
    if gameProcessed then return end
    if input.KeyCode == Enum.KeyCode.L then
        toggleGui()
    end
end)

local smallGui = Instance.new("ScreenGui")
smallGui.Name = "LemonHubToggle"
smallGui.ResetOnSpawn = false
smallGui.Parent = playerGui

local toggleButton = Instance.new("TextButton")
toggleButton.Size = UDim2.new(0,35,0,35)
toggleButton.Position = UDim2.new(1,-45,1,-45)
toggleButton.BackgroundColor3 = Color3.fromRGB(40,40,40)
toggleButton.TextColor3 = Color3.fromRGB(255,255,255)
toggleButton.Text = "L"
toggleButton.TextScaled = true
toggleButton.Font = Enum.Font.GothamBold
toggleButton.Parent = smallGui

local toggleCorner = Instance.new("UICorner")
toggleCorner.CornerRadius = UDim.new(0,10)
toggleCorner.Parent = toggleButton

enableDragging(toggleButton)
toggleButton.MouseButton1Click:Connect(toggleGui)

local function findTarget()
    local inputText = string.lower(usernameBox.Text)
    for _, plr in ipairs(Players:GetPlayers()) do
        if string.find(string.lower(plr.Name), inputText) or string.find(string.lower(plr.DisplayName), inputText) then
            return plr
        end
    end
    return nil
end

local function getTool()
    local backpack = player:WaitForChild("Backpack")
    local tool = backpack:FindFirstChild("Normal")
    if tool then
        tool.Parent = player.Character
        return tool
    end
    return player.Character:FindFirstChild("Normal")
end

local remote = game:GetService("ReplicatedStorage"):WaitForChild("Framework"):WaitForChild("Network"):WaitForChild("HandcuffRemote")

pullButton.MouseButton1Click:Connect(function()
    local target = findTarget()
    if not target or not target.Character then return end
    local tool = getTool()
    if tool then
        remote:InvokeServer(tool, target.Character)
    end
end)

killButton.MouseButton1Click:Connect(function()
    local target = findTarget()
    if not target or not target.Character then return end
    local tool = getTool()
    if not tool then return end
    local hrp = player.Character:WaitForChild("HumanoidRootPart")
    local originalCFrame = hrp.CFrame
    remote:InvokeServer(tool, target.Character)
    task.wait(0.2)
    hrp.CFrame = CFrame.new(279.303, -915.413, 168.403)
    task.wait(0.2)
    remote:InvokeServer(tool, target.Character)
    task.wait(0.3)
    hrp.CFrame = originalCFrame
end)

foidButton.MouseButton1Click:Connect(function()
    local target = findTarget()
    if not target or not target.Character then return end
    local tool = getTool()
    if not tool then return end
    local hrp = player.Character:WaitForChild("HumanoidRootPart")
    local originalCFrame = hrp.CFrame
    remote:InvokeServer(tool, target.Character)
    task.wait(0.2)
    hrp.CFrame = CFrame.new(-2338071.75, 21599260, -769617.562, -0.887405515, -0.0953957215, 0.451011211, 8.69690764e-10, 0.978354335, 0.206936792, -0.460989654, 0.183636859, -0.868197024)
    task.wait(0.2)
    remote:InvokeServer(tool, target.Character)
    task.wait(0.3)
    hrp.CFrame = originalCFrame
end)

teleportButton.MouseButton1Click:Connect(function()
    local target = findTarget()
    if target and target.Character then
        local hrp = player.Character:WaitForChild("HumanoidRootPart")
        hrp.CFrame = target.Character:WaitForChild("HumanoidRootPart").CFrame
    end
end)

local cameraFollowing = false
local camera = workspace.CurrentCamera
viewButton.MouseButton1Click:Connect(function()
    local target = findTarget()
    if not target or not target.Character then return end
    if not cameraFollowing then
        camera.CameraSubject = target.Character:WaitForChild("Humanoid")
        cameraFollowing = true
    else
        camera.CameraSubject = player.Character:WaitForChild("Humanoid")
        cameraFollowing = false
    end
end)

antiAfkButton.MouseButton1Click:Connect(function()
    local VirtualUser = game:GetService('VirtualUser')
    player.Idled:Connect(function()
        VirtualUser:CaptureController()
        VirtualUser:ClickButton2(Vector2.new())
    end)
    game:GetService("StarterGui"):SetCore("SendNotification", {
        Title = "Hey!",
        Text = "مضاد افك مفعل✅",
        Button1 = "أخفاء",
        Duration = 5
    })
end)

antiKillButton.MouseButton1Click:Connect(function()
    workspace.FallenPartsDestroyHeight = 0/0
    game:GetService("StarterGui"):SetCore("SendNotification", {
        Title = "Hey!",
        Text = "مضاد قتل مفعل✅",
        Button1 = "أخفاء",
        Duration = 5
    })
end)

-- FPS Display top-right
local fpsGui = Instance.new("ScreenGui")
fpsGui.Name = "FPSDisplay"
fpsGui.ResetOnSpawn = false
fpsGui.Parent = playerGui

local fpsLabel = Instance.new("TextLabel")
fpsLabel.Size = UDim2.new(0,100,0,25)
fpsLabel.Position = UDim2.new(1,-110,0,10)
fpsLabel.BackgroundTransparency = 1
fpsLabel.TextColor3 = Color3.fromRGB(255,255,255)
fpsLabel.TextScaled = true
fpsLabel.Font = Enum.Font.GothamBold
fpsLabel.Text = "FPS: 0"
fpsLabel.Parent = fpsGui

local frameCount = 0
local elapsed = 0
local updateInterval = 2

RunService.RenderStepped:Connect(function(dt)
    frameCount += 1
    elapsed += dt
    if elapsed >= updateInterval then
        fpsLabel.Text = "FPS: "..math.floor(frameCount / elapsed)
        frameCount = 0
        elapsed = 0
    end
end)
